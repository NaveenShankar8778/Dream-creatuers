<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Smart Home Dashboard - Login</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<!-- Firebase SDKs -->
		<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>

		<style>
			/* Page layout */
			body {
				background: #0d1117;
				color: #e6edf3;
				font-family: "Segoe UI", Arial, sans-serif;
				text-align: center;
				padding: 30px;
				margin: 0;
				min-height: 100vh;
				display: flex;
				flex-direction: column;
				align-items: center;
			}

			h1 {
				color: #00d9ff;
				font-size: 2rem;
				margin-bottom: 20px;
			}

			/* === Login Form === */
			#loginForm {
				background: #161b22;
				border-radius: 15px;
				padding: 30px 20px;
				max-width: 400px;
				width: 100%;
				margin: 60px auto;
				box-shadow: 0px 0px 10px rgba(0, 217, 255, 0.3);
			}

			#loginForm input {
				width: 100%;
				padding: 12px;
				margin: 10px 0;
				border: none;
				border-radius: 10px;
				background: #0d1117;
				color: #e6edf3;
				border: 1px solid #00d9ff;
				font-size: 1rem;
				box-sizing: border-box;
			}

			#loginForm button {
				width: 100%;
				padding: 12px;
				background: #00d9ff;
				color: #000;
				border: none;
				border-radius: 10px;
				font-weight: bold;
				font-size: 1rem;
				cursor: pointer;
				margin-top: 10px;
				transition: 0.3s;
			}

			#loginForm button:hover {
				background: #00b5d8;
			}

			/* === Dashboard === */
			#dashboard {
				display: none;
				width: 100%;
			}

			.container {
				display: flex;
				flex-wrap: wrap;
				justify-content: center;
				align-items: flex-start;
				gap: 20px;
				max-width: 1100px;
				margin: 0 auto;
				padding: 20px;
				box-sizing: border-box;
			}

			.card {
				background: #161b22;
				border-radius: 15px;
				padding: 20px;
				width: 280px;
				box-shadow: 0px 0px 10px rgba(0, 217, 255, 0.3);
				transition: 0.3s;
				display: flex;
				flex-direction: column;
				align-items: center;
				text-align: center;
			}

			.card:hover {
				box-shadow: 0px 0px 15px rgba(0, 217, 255, 0.6);
			}

			h2 {
				color: #00d9ff;
			}

			button.device-btn {
				background: #00d9ff;
				border: none;
				border-radius: 10px;
				padding: 10px 20px;
				color: #000;
				font-weight: bold;
				cursor: pointer;
				margin: 10px auto;
				transition: 0.3s;
				width: 80%;
				max-width: 220px;
			}

			button.device-btn:hover {
				background: #00b5d8;
			}

			#logoutBtn {
				background: #ff4d4d;
				color: white;
				padding: 12px 25px;
				border: none;
				border-radius: 10px;
				cursor: pointer;
				font-size: 1rem;
				margin-top: 30px;
			}

			#logoutBtn:hover {
				background: #e63946;
			}

			.status {
				font-weight: bold;
				color: #ffd700;
			}

			.sensor {
				font-size: 1.1rem;
				margin: 10px 0;
			}
		</style>
	</head>
	<body>
		<h1>Smart Home Dashboard</h1>

		<!-- Login Form -->
		<div id="loginForm">
			<input type="email" id="email" placeholder="Enter Email" required />
			<input type="password" id="password" placeholder="Enter Password" required />
			<button id="loginBtn">Login</button>
		</div>

		<!-- Dashboard -->
		<div id="dashboard">
			<div class="container">
				<!-- Light 1 -->
				<div class="card">
					<h2>Light 1</h2>
					<p>Status: <span id="Light1-status" class="status">Loading...</span></p>
					<button class="device-btn" onclick="updateDevice('Light1', true)">Turn ON</button>
					<button class="device-btn" onclick="updateDevice('Light1', false)">Turn OFF</button>
				</div>

				<!-- Light 2 -->
				<div class="card">
					<h2>Light 2</h2>
					<p>Status: <span id="Light2-status" class="status">Loading...</span></p>
					<button class="device-btn" onclick="updateDevice('Light2', true)">Turn ON</button>
					<button class="device-btn" onclick="updateDevice('Light2', false)">Turn OFF</button>
				</div>

				<!-- Light 3 -->
				<div class="card">
					<h2>Light 3</h2>
					<p>Status: <span id="Light3-status" class="status">Loading...</span></p>
					<button class="device-btn" onclick="updateDevice('Light3', true)">Turn ON</button>
					<button class="device-btn" onclick="updateDevice('Light3', false)">Turn OFF</button>
				</div>

				<!-- Fan -->
				<div class="card">
					<h2>Fan</h2>
					<p>Status: <span id="Fan-status" class="status">Loading...</span></p>
					<button class="device-btn" onclick="updateDevice('Fan', true)">Turn ON</button>
					<button class="device-btn" onclick="updateDevice('Fan', false)">Turn OFF</button>
				</div>

				<!-- Sensors -->
				<div class="card">
					<h2>Sensor Data</h2>
					<p class="sensor">üå° Temperature: <span id="Temperature">0</span> ¬∞C</p>
					<p class="sensor">üíß Humidity: <span id="Humidity">0</span> %</p>
					<p class="sensor">üëÅ Motion: <span id="Motion-status">No Motion</span></p>
				</div>
			</div>

			<button id="logoutBtn">Logout</button>
		</div>

		<script>
			// ‚úÖ Firebase Configuration
			const firebaseConfig = {
				apiKey: "AIzaSyAeL7hKrtxCm0Ez53FtR7xa9Z-16MhYkZI",
				authDomain: "smart-home-automation-relay.firebaseapp.com",
				databaseURL: "https://smart-home-automation-relay-default-rtdb.firebaseio.com",
				projectId: "smart-home-automation-relay",
				storageBucket: "smart-home-automation-relay.firebasestorage.app",
				messagingSenderId: "908069254525",
				appId: "1:908069254525:web:da7fa19559690fa4608814",
			};

			// ‚úÖ Initialize Firebase
			firebase.initializeApp(firebaseConfig);
			const db = firebase.database();
			const auth = firebase.auth();

			const loginForm = document.getElementById("loginForm");
			const dashboard = document.getElementById("dashboard");
			const loginBtn = document.getElementById("loginBtn");
			const logoutBtn = document.getElementById("logoutBtn");

			// ‚úÖ Login Functionality
			loginBtn.addEventListener("click", () => {
				const email = document.getElementById("email").value.trim();
				const password = document.getElementById("password").value;

				if (!email || !password) {
					alert("Please enter both email and password.");
					return;
				}

				auth
					.signInWithEmailAndPassword(email, password)
					.then((userCredential) => {
						loginForm.style.display = "none";
						dashboard.style.display = "block";
						startDashboard();
					})
					.catch((error) => {
						// show both the error code and message so it's easier to debug
						alert("Login failed: " + error.code + " ‚Äî " + error.message);
						console.error("Firebase auth error:", error);
					});
			});

			// ‚úÖ Logout Functionality
			logoutBtn.addEventListener("click", () => {
				auth.signOut().then(() => {
					dashboard.style.display = "none";
					loginForm.style.display = "block";
					document.getElementById("email").value = "";
					document.getElementById("password").value = "";
				});
			});

			// ‚úÖ Dashboard Controls
			function startDashboard() {
				function updateDevice(device, value) {
					db.ref(device).set(value);
				}
				window.updateDevice = updateDevice;

				function listenDevice(device, elementId) {
					db.ref(device).on("value", (snapshot) => {
						const val = snapshot.val();
						document.getElementById(elementId).textContent = val;
					});
				}

				listenDevice("Light1", "Light1-status");
				listenDevice("Light2", "Light2-status");
				listenDevice("Light3", "Light3-status");
				listenDevice("Fan", "Fan-status");
				listenDevice("Temperature", "Temperature");
				listenDevice("Humidity", "Humidity");

				db.ref("Motion").on("value", (snapshot) => {
					const val = snapshot.val();
					document.getElementById("Motion-status").textContent = val ? "Motion Detected" : "No Motion";
				});
			}
		</script>
	</body>
</html>